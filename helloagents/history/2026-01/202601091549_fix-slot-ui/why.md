# 变更提案: 修复槽位功能不可用（Issue #29）

## 需求背景

当前 FRouter「路由规则」界面能够看到“槽位”相关展示/选项，但缺少对槽位本身的管理入口，导致：

1. 只能“看到槽位”，无法配置（绑定节点/改名/新增）。
2. 槽位的预期语义类似 Clash 的 selector（可在多个节点间切换），但现状无法在 UI 中完成绑定与切换。

Issue #29（Windows 10 x64，Vea 2.2.0-Release）反馈：规则配置中出现槽位，但没有任何配置界面或修改界面。

## 变更内容

1. 在 FRouter「路由规则」面板新增“槽位管理”入口与弹窗：支持新增槽位、重命名、绑定/解绑节点。
2. 在规则编辑弹窗中，槽位选项展示更清晰：显示槽位名称与绑定状态，并在槽位变更后可即时刷新选项显示。

## 影响范围

- **模块:** frontend
- **文件:** `frontend/theme/light.html`、`frontend/theme/dark.html`
- **API:** 无新增（复用 `/frouters/:id/graph` 读写 slots）
- **数据:** 复用现有 `ChainProxySettings.slots`（slot id/name/boundNodeId）

## 核心场景

### 需求: 槽位可管理
**模块:** frontend
在 FRouter 维度管理 slots（新增/重命名/绑定）。

#### 场景: 新增槽位
在“路由规则”面板点击“槽位管理”，新增一个槽位。
- 预期结果：新增的 `slot-N` 出现在槽位列表中，并可用于规则去向选择。

#### 场景: 重命名槽位
在“槽位管理”中修改槽位名称。
- 预期结果：规则列表与规则编辑弹窗中，槽位显示名称同步更新。

#### 场景: 绑定或解绑槽位
在“槽位管理”中将槽位绑定到一个具体节点，或设置为“未绑定”。
- 预期结果：槽位选项显示“已绑定/未绑定”状态；绑定到节点后，相关规则编译时可解析为实际节点。

### 需求: 规则可选择槽位
**模块:** frontend
在规则编辑弹窗中将“匹配后去向”选择为某个槽位。

#### 场景: 编辑规则选择槽位并显示状态
- 预期结果：下拉选项中展示槽位名称与绑定状态；选择槽位后保存规则不报错。

### 需求: 保存后生效
**模块:** frontend/backend
保存图配置后，后端持久化 slots，并在需要时触发代理重启以应用配置。

#### 场景: 保存图配置并应用到代理
- 预期结果：点击“保存”后调用 `/frouters/:id/graph` 持久化；若代理正在运行，按既有逻辑计划重启并应用新配置。

## 风险评估

- **风险:** 用户误操作导致槽位与规则引用不一致（例如删除/改 ID）。
- **缓解:** UI 不开放编辑 slot id；仅允许新增、重命名、绑定/解绑。删除能力如实现，需做“被引用保护/二次确认”。

