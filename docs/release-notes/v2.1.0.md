> 版本：v2.1.0（从 v1.2.1 升级；架构 v2 + 路由/测速语义收敛 + 稳定性修复）

## 亮点

- **架构 v2.1**：Repository/Service/Facade 分层；事件驱动快照持久化；启动时严格校验 `schemaVersion`，避免误覆盖 `state.json`。
- **FRouter 成为唯一真相**：FRouter 图编译输出统一用于代理运行与端到端测速/延迟，不再“跑一套、测一套”。
- **代理稳定性**：重启失败不再静默；避免重启失败导致代理中断；Windows 上测速重试更稳定。
- **可用性改进**：支持分享链接导入节点；订阅节点改名标签；TUN 设置变更后自动刷新状态。
- **构建/CI**：修复跨平台构建与 Windows 打包后端路径；修复 `make dev` 二进制复制；启动按需安装内核并移除 CI 的 xray 下载。

## 破坏性变更 / 迁移说明

- 本项目不承诺 API/状态向后兼容：以 `FRouter`/`/frouters`/`frouterId` 为唯一对外口径（详见 `docs/ARCHITECTURE_V2.md`）。
- 状态文件 `data/state.json` 的 `schemaVersion` 为 `2.1.0`；不支持的版本会**拒绝启动**（这是为了避免“启动失败后覆盖 state”这种不可逆事故）。

## PR 记录（本次发布包含）

- #11 引入一万个东西

## 变更列表（PR #11 内的提交）

- refactor: 引入 V2 架构并修复 /snapshot
- fix: 修复 state 迁移与 /snapshot
- fix: sync nodes and restore routing defaults
- refactor: 统一 FRouter 路由/测速并刷新主题
- fix: 修复跨平台构建与 Windows 打包后端路径
- refactor: 封装仓储聚合器并统一编译错误处理
- fix: TUN 设置变更后刷新状态
- refactor(api): unify ProxyConfig patching and expose graph save effects
- fix: 修复 Windows CI 测试失败
- fix: 统一文档逗号并修复 make dev 二进制复制
- feat: 支持分享链接导入节点与订阅节点改名标签
- fix: 启动时按需安装内核并移除 CI xray 下载
- fix: 停止静默丢错并补齐测试
- fix: 报告代理自动重启失败
- fix: prevent proxy outage on restart failure
- fix: make speed test retry stable on Windows
